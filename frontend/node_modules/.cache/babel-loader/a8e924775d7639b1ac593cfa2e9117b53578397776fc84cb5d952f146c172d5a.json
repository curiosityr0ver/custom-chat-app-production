{"ast":null,"code":"import{Modal,ModalOverlay,ModalContent,ModalHeader,ModalFooter,ModalBody,ModalCloseButton,Button,useDisclosure,FormControl,Input,useToast,Box}from\"@chakra-ui/react\";import axios from\"axios\";import{useState}from\"react\";import{ChatState}from\"../../context/ChatProvider\";import UserBadgeItem from\"../userAvatar/UserBadgeItem\";import UserListItem from\"../userAvatar/UserListItem\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const GroupChatModal=_ref=>{let{children}=_ref;const{isOpen,onOpen,onClose}=useDisclosure();const[groupChatName,setGroupChatName]=useState();const[selectedUsers,setSelectedUsers]=useState([]);const[search,setSearch]=useState(\"\");const[searchResult,setSearchResult]=useState([]);const[loading,setLoading]=useState(false);const toast=useToast();const{user,chats,setChats}=ChatState();const handleGroup=userToAdd=>{if(selectedUsers.includes(userToAdd)){toast({title:\"User already added\",status:\"warning\",duration:5000,isClosable:true,position:\"top\"});return;}setSelectedUsers([...selectedUsers,userToAdd]);};const handleSearch=async query=>{setSearch(query);if(!query){return;}try{setLoading(true);const config={headers:{Authorization:\"Bearer \".concat(user.token)}};const{data}=await axios.get(\"/api/user?search=\".concat(search),config);setTimeout(()=>{setLoading(false);setSearchResult(data);},1000);}catch(error){toast({title:\"Error Occured!\",description:\"Failed to Load the Search Results\",status:\"error\",duration:5000,isClosable:true,position:\"bottom-left\"});}};const handleDelete=delUser=>{const newUsersList=selectedUsers.filter(sel=>sel._id!==delUser._id);setSelectedUsers(newUsersList);};const handleSubmit=async()=>{if(!groupChatName||!selectedUsers){toast({title:\"Please fill all the feilds\",status:\"warning\",duration:5000,isClosable:true,position:\"top\"});return;}try{const config={headers:{Authorization:\"Bearer \".concat(user.token)}};const{data}=await axios.post(\"/api/chat/group\",{name:groupChatName,users:JSON.stringify(selectedUsers.map(u=>u._id))},config);setChats([data,...chats]);onClose();toast({title:\"New Group Chat Created!\",status:\"success\",duration:5000,isClosable:true,position:\"bottom\"});}catch(error){toast({title:\"Failed to Create the Chat!\",description:error.response.data,status:\"error\",duration:5000,isClosable:true,position:\"bottom\"});}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{onClick:onOpen,children:children}),/*#__PURE__*/_jsxs(Modal,{onClose:onClose,isOpen:isOpen,isCentered:true,children:[/*#__PURE__*/_jsx(ModalOverlay,{}),/*#__PURE__*/_jsxs(ModalContent,{children:[/*#__PURE__*/_jsx(ModalHeader,{fontSize:\"35px\",fontFamily:\"Work sans\",d:\"flex\",justifyContent:\"center\",children:\"Create Group Chat\"}),/*#__PURE__*/_jsx(ModalCloseButton,{}),/*#__PURE__*/_jsxs(ModalBody,{d:\"flex\",flexDir:\"column\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(FormControl,{children:/*#__PURE__*/_jsx(Input,{placeholder:\"Chat Name\",mb:3,onChange:e=>setGroupChatName(e.target.value)})}),/*#__PURE__*/_jsx(FormControl,{children:/*#__PURE__*/_jsx(Input,{placeholder:\"Add Users eg: John, Piyush, Jane\",mb:1,onChange:e=>handleSearch(e.target.value)})}),/*#__PURE__*/_jsx(Box,{w:\"100%\",d:\"flex\",flexWrap:\"wrap\",children:selectedUsers.map(u=>/*#__PURE__*/_jsx(UserBadgeItem,{user:u,handleFunction:()=>handleDelete(u)},u._id))}),loading?/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}):searchResult.map(user=>/*#__PURE__*/_jsx(UserListItem,{user:user,handleFunction:()=>handleGroup(user)},user._id))]}),/*#__PURE__*/_jsx(ModalFooter,{children:/*#__PURE__*/_jsx(Button,{onClick:handleSubmit,colorScheme:\"blue\",children:\"Create Chat\"})})]})]})]});};export default GroupChatModal;","map":{"version":3,"names":["Modal","ModalOverlay","ModalContent","ModalHeader","ModalFooter","ModalBody","ModalCloseButton","Button","useDisclosure","FormControl","Input","useToast","Box","axios","useState","ChatState","UserBadgeItem","UserListItem","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","GroupChatModal","_ref","children","isOpen","onOpen","onClose","groupChatName","setGroupChatName","selectedUsers","setSelectedUsers","search","setSearch","searchResult","setSearchResult","loading","setLoading","toast","user","chats","setChats","handleGroup","userToAdd","includes","title","status","duration","isClosable","position","handleSearch","query","config","headers","Authorization","concat","token","data","get","setTimeout","error","description","handleDelete","delUser","newUsersList","filter","sel","_id","handleSubmit","post","name","users","JSON","stringify","map","u","response","onClick","isCentered","fontSize","fontFamily","d","justifyContent","flexDir","alignItems","placeholder","mb","onChange","e","target","value","w","flexWrap","handleFunction","colorScheme"],"sources":["C:/Users/mehta/OneDrive/Documents/custom-chat-app/frontend/src/components/miscellaneous/GroupChatModal.js"],"sourcesContent":["import {\r\n    Modal,\r\n    ModalOverlay,\r\n    ModalContent,\r\n    ModalHeader,\r\n    ModalFooter,\r\n    ModalBody,\r\n    ModalCloseButton,\r\n    Button,\r\n    useDisclosure,\r\n    FormControl,\r\n    Input,\r\n    useToast,\r\n    Box,\r\n} from \"@chakra-ui/react\";\r\nimport axios from \"axios\";\r\nimport { useState } from \"react\";\r\nimport { ChatState } from \"../../context/ChatProvider\";\r\nimport UserBadgeItem from \"../userAvatar/UserBadgeItem\";\r\nimport UserListItem from \"../userAvatar/UserListItem\";\r\n\r\nconst GroupChatModal = ({ children }) => {\r\n    const { isOpen, onOpen, onClose } = useDisclosure();\r\n    const [groupChatName, setGroupChatName] = useState();\r\n    const [selectedUsers, setSelectedUsers] = useState([]);\r\n    const [search, setSearch] = useState(\"\");\r\n    const [searchResult, setSearchResult] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const toast = useToast();\r\n\r\n    const { user, chats, setChats } = ChatState();\r\n\r\n    const handleGroup = (userToAdd) => {\r\n        if (selectedUsers.includes(userToAdd)) {\r\n            toast({\r\n                title: \"User already added\",\r\n                status: \"warning\",\r\n                duration: 5000,\r\n                isClosable: true,\r\n                position: \"top\",\r\n            });\r\n            return;\r\n        }\r\n\r\n        setSelectedUsers([...selectedUsers, userToAdd]);\r\n    };\r\n\r\n    const handleSearch = async (query) => {\r\n        setSearch(query);\r\n        if (!query) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            setLoading(true);\r\n\r\n            const config = {\r\n                headers: {\r\n                    Authorization: `Bearer ${user.token}`,\r\n                },\r\n            };\r\n            const { data } = await axios.get(`/api/user?search=${search}`, config);\r\n            setTimeout(() => {\r\n                setLoading(false);\r\n                setSearchResult(data);\r\n            }, 1000);\r\n\r\n        } catch (error) {\r\n            toast({\r\n                title: \"Error Occured!\",\r\n                description: \"Failed to Load the Search Results\",\r\n                status: \"error\",\r\n                duration: 5000,\r\n                isClosable: true,\r\n                position: \"bottom-left\",\r\n            });\r\n        }\r\n    };\r\n\r\n    const handleDelete = (delUser) => {\r\n        const newUsersList = selectedUsers.filter((sel) => sel._id !== delUser._id);\r\n        setSelectedUsers(newUsersList);\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        if (!groupChatName || !selectedUsers) {\r\n            toast({\r\n                title: \"Please fill all the feilds\",\r\n                status: \"warning\",\r\n                duration: 5000,\r\n                isClosable: true,\r\n                position: \"top\",\r\n            });\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const config = {\r\n                headers: {\r\n                    Authorization: `Bearer ${user.token}`,\r\n                },\r\n            };\r\n            const { data } = await axios.post(\r\n                `/api/chat/group`,\r\n                {\r\n                    name: groupChatName,\r\n                    users: JSON.stringify(selectedUsers.map((u) => u._id)),\r\n                },\r\n                config\r\n            );\r\n            setChats([data, ...chats]);\r\n            onClose();\r\n            toast({\r\n                title: \"New Group Chat Created!\",\r\n                status: \"success\",\r\n                duration: 5000,\r\n                isClosable: true,\r\n                position: \"bottom\",\r\n            });\r\n        } catch (error) {\r\n            toast({\r\n                title: \"Failed to Create the Chat!\",\r\n                description: error.response.data,\r\n                status: \"error\",\r\n                duration: 5000,\r\n                isClosable: true,\r\n                position: \"bottom\",\r\n            });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <span onClick={onOpen}>{children}</span>\r\n\r\n            <Modal onClose={onClose} isOpen={isOpen} isCentered>\r\n                <ModalOverlay />\r\n                <ModalContent>\r\n                    <ModalHeader\r\n                        fontSize=\"35px\"\r\n                        fontFamily=\"Work sans\"\r\n                        d=\"flex\"\r\n                        justifyContent=\"center\"\r\n                    >\r\n                        Create Group Chat\r\n                    </ModalHeader>\r\n                    <ModalCloseButton />\r\n                    <ModalBody d=\"flex\" flexDir=\"column\" alignItems=\"center\">\r\n                        <FormControl>\r\n                            <Input\r\n                                placeholder=\"Chat Name\"\r\n                                mb={3}\r\n                                onChange={(e) => setGroupChatName(e.target.value)}\r\n                            />\r\n                        </FormControl>\r\n                        <FormControl>\r\n                            <Input\r\n                                placeholder=\"Add Users eg: John, Piyush, Jane\"\r\n                                mb={1}\r\n                                onChange={(e) => handleSearch(e.target.value)}\r\n                            />\r\n                        </FormControl>\r\n                        <Box w=\"100%\" d=\"flex\" flexWrap=\"wrap\">\r\n                            {selectedUsers.map((u) => (\r\n                                <UserBadgeItem\r\n                                    key={u._id}\r\n                                    user={u}\r\n                                    handleFunction={() => handleDelete(u)}\r\n                                />\r\n                            ))}\r\n                        </Box>\r\n                        {loading ? (\r\n                            <div>Loading...</div>\r\n                        ) : (\r\n                            searchResult\r\n                                .map((user) => (\r\n                                    <UserListItem\r\n                                        key={user._id}\r\n                                        user={user}\r\n                                        handleFunction={() => handleGroup(user)}\r\n                                    />\r\n                                ))\r\n                        )}\r\n                    </ModalBody>\r\n                    <ModalFooter>\r\n                        <Button onClick={handleSubmit} colorScheme=\"blue\">\r\n                            Create Chat\r\n                        </Button>\r\n                    </ModalFooter>\r\n                </ModalContent>\r\n            </Modal>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default GroupChatModal;\r\n"],"mappings":"AAAA,OACIA,KAAK,CACLC,YAAY,CACZC,YAAY,CACZC,WAAW,CACXC,WAAW,CACXC,SAAS,CACTC,gBAAgB,CAChBC,MAAM,CACNC,aAAa,CACbC,WAAW,CACXC,KAAK,CACLC,QAAQ,CACRC,GAAG,KACA,kBAAkB,CACzB,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,KAAQ,OAAO,CAChC,OAASC,SAAS,KAAQ,4BAA4B,CACtD,MAAO,CAAAC,aAAa,KAAM,6BAA6B,CACvD,MAAO,CAAAC,YAAY,KAAM,4BAA4B,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAEtD,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAChC,KAAM,CAAEE,MAAM,CAAEC,MAAM,CAAEC,OAAQ,CAAC,CAAGrB,aAAa,CAAC,CAAC,CACnD,KAAM,CAACsB,aAAa,CAAEC,gBAAgB,CAAC,CAAGjB,QAAQ,CAAC,CAAC,CACpD,KAAM,CAACkB,aAAa,CAAEC,gBAAgB,CAAC,CAAGnB,QAAQ,CAAC,EAAE,CAAC,CACtD,KAAM,CAACoB,MAAM,CAAEC,SAAS,CAAC,CAAGrB,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACsB,YAAY,CAAEC,eAAe,CAAC,CAAGvB,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACwB,OAAO,CAAEC,UAAU,CAAC,CAAGzB,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAA0B,KAAK,CAAG7B,QAAQ,CAAC,CAAC,CAExB,KAAM,CAAE8B,IAAI,CAAEC,KAAK,CAAEC,QAAS,CAAC,CAAG5B,SAAS,CAAC,CAAC,CAE7C,KAAM,CAAA6B,WAAW,CAAIC,SAAS,EAAK,CAC/B,GAAIb,aAAa,CAACc,QAAQ,CAACD,SAAS,CAAC,CAAE,CACnCL,KAAK,CAAC,CACFO,KAAK,CAAE,oBAAoB,CAC3BC,MAAM,CAAE,SAAS,CACjBC,QAAQ,CAAE,IAAI,CACdC,UAAU,CAAE,IAAI,CAChBC,QAAQ,CAAE,KACd,CAAC,CAAC,CACF,OACJ,CAEAlB,gBAAgB,CAAC,CAAC,GAAGD,aAAa,CAAEa,SAAS,CAAC,CAAC,CACnD,CAAC,CAED,KAAM,CAAAO,YAAY,CAAG,KAAO,CAAAC,KAAK,EAAK,CAClClB,SAAS,CAACkB,KAAK,CAAC,CAChB,GAAI,CAACA,KAAK,CAAE,CACR,OACJ,CAEA,GAAI,CACAd,UAAU,CAAC,IAAI,CAAC,CAEhB,KAAM,CAAAe,MAAM,CAAG,CACXC,OAAO,CAAE,CACLC,aAAa,WAAAC,MAAA,CAAYhB,IAAI,CAACiB,KAAK,CACvC,CACJ,CAAC,CACD,KAAM,CAAEC,IAAK,CAAC,CAAG,KAAM,CAAA9C,KAAK,CAAC+C,GAAG,qBAAAH,MAAA,CAAqBvB,MAAM,EAAIoB,MAAM,CAAC,CACtEO,UAAU,CAAC,IAAM,CACbtB,UAAU,CAAC,KAAK,CAAC,CACjBF,eAAe,CAACsB,IAAI,CAAC,CACzB,CAAC,CAAE,IAAI,CAAC,CAEZ,CAAE,MAAOG,KAAK,CAAE,CACZtB,KAAK,CAAC,CACFO,KAAK,CAAE,gBAAgB,CACvBgB,WAAW,CAAE,mCAAmC,CAChDf,MAAM,CAAE,OAAO,CACfC,QAAQ,CAAE,IAAI,CACdC,UAAU,CAAE,IAAI,CAChBC,QAAQ,CAAE,aACd,CAAC,CAAC,CACN,CACJ,CAAC,CAED,KAAM,CAAAa,YAAY,CAAIC,OAAO,EAAK,CAC9B,KAAM,CAAAC,YAAY,CAAGlC,aAAa,CAACmC,MAAM,CAAEC,GAAG,EAAKA,GAAG,CAACC,GAAG,GAAKJ,OAAO,CAACI,GAAG,CAAC,CAC3EpC,gBAAgB,CAACiC,YAAY,CAAC,CAClC,CAAC,CAED,KAAM,CAAAI,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CAACxC,aAAa,EAAI,CAACE,aAAa,CAAE,CAClCQ,KAAK,CAAC,CACFO,KAAK,CAAE,4BAA4B,CACnCC,MAAM,CAAE,SAAS,CACjBC,QAAQ,CAAE,IAAI,CACdC,UAAU,CAAE,IAAI,CAChBC,QAAQ,CAAE,KACd,CAAC,CAAC,CACF,OACJ,CAEA,GAAI,CACA,KAAM,CAAAG,MAAM,CAAG,CACXC,OAAO,CAAE,CACLC,aAAa,WAAAC,MAAA,CAAYhB,IAAI,CAACiB,KAAK,CACvC,CACJ,CAAC,CACD,KAAM,CAAEC,IAAK,CAAC,CAAG,KAAM,CAAA9C,KAAK,CAAC0D,IAAI,mBAE7B,CACIC,IAAI,CAAE1C,aAAa,CACnB2C,KAAK,CAAEC,IAAI,CAACC,SAAS,CAAC3C,aAAa,CAAC4C,GAAG,CAAEC,CAAC,EAAKA,CAAC,CAACR,GAAG,CAAC,CACzD,CAAC,CACDf,MACJ,CAAC,CACDX,QAAQ,CAAC,CAACgB,IAAI,CAAE,GAAGjB,KAAK,CAAC,CAAC,CAC1Bb,OAAO,CAAC,CAAC,CACTW,KAAK,CAAC,CACFO,KAAK,CAAE,yBAAyB,CAChCC,MAAM,CAAE,SAAS,CACjBC,QAAQ,CAAE,IAAI,CACdC,UAAU,CAAE,IAAI,CAChBC,QAAQ,CAAE,QACd,CAAC,CAAC,CACN,CAAE,MAAOW,KAAK,CAAE,CACZtB,KAAK,CAAC,CACFO,KAAK,CAAE,4BAA4B,CACnCgB,WAAW,CAAED,KAAK,CAACgB,QAAQ,CAACnB,IAAI,CAChCX,MAAM,CAAE,OAAO,CACfC,QAAQ,CAAE,IAAI,CACdC,UAAU,CAAE,IAAI,CAChBC,QAAQ,CAAE,QACd,CAAC,CAAC,CACN,CACJ,CAAC,CAED,mBACI9B,KAAA,CAAAE,SAAA,EAAAG,QAAA,eACIP,IAAA,SAAM4D,OAAO,CAAEnD,MAAO,CAAAF,QAAA,CAAEA,QAAQ,CAAO,CAAC,cAExCL,KAAA,CAACrB,KAAK,EAAC6B,OAAO,CAAEA,OAAQ,CAACF,MAAM,CAAEA,MAAO,CAACqD,UAAU,MAAAtD,QAAA,eAC/CP,IAAA,CAAClB,YAAY,GAAE,CAAC,cAChBoB,KAAA,CAACnB,YAAY,EAAAwB,QAAA,eACTP,IAAA,CAAChB,WAAW,EACR8E,QAAQ,CAAC,MAAM,CACfC,UAAU,CAAC,WAAW,CACtBC,CAAC,CAAC,MAAM,CACRC,cAAc,CAAC,QAAQ,CAAA1D,QAAA,CAC1B,mBAED,CAAa,CAAC,cACdP,IAAA,CAACb,gBAAgB,GAAE,CAAC,cACpBe,KAAA,CAAChB,SAAS,EAAC8E,CAAC,CAAC,MAAM,CAACE,OAAO,CAAC,QAAQ,CAACC,UAAU,CAAC,QAAQ,CAAA5D,QAAA,eACpDP,IAAA,CAACV,WAAW,EAAAiB,QAAA,cACRP,IAAA,CAACT,KAAK,EACF6E,WAAW,CAAC,WAAW,CACvBC,EAAE,CAAE,CAAE,CACNC,QAAQ,CAAGC,CAAC,EAAK3D,gBAAgB,CAAC2D,CAAC,CAACC,MAAM,CAACC,KAAK,CAAE,CACrD,CAAC,CACO,CAAC,cACdzE,IAAA,CAACV,WAAW,EAAAiB,QAAA,cACRP,IAAA,CAACT,KAAK,EACF6E,WAAW,CAAC,kCAAkC,CAC9CC,EAAE,CAAE,CAAE,CACNC,QAAQ,CAAGC,CAAC,EAAKtC,YAAY,CAACsC,CAAC,CAACC,MAAM,CAACC,KAAK,CAAE,CACjD,CAAC,CACO,CAAC,cACdzE,IAAA,CAACP,GAAG,EAACiF,CAAC,CAAC,MAAM,CAACV,CAAC,CAAC,MAAM,CAACW,QAAQ,CAAC,MAAM,CAAApE,QAAA,CACjCM,aAAa,CAAC4C,GAAG,CAAEC,CAAC,eACjB1D,IAAA,CAACH,aAAa,EAEVyB,IAAI,CAAEoC,CAAE,CACRkB,cAAc,CAAEA,CAAA,GAAM/B,YAAY,CAACa,CAAC,CAAE,EAFjCA,CAAC,CAACR,GAGV,CACJ,CAAC,CACD,CAAC,CACL/B,OAAO,cACJnB,IAAA,QAAAO,QAAA,CAAK,YAAU,CAAK,CAAC,CAErBU,YAAY,CACPwC,GAAG,CAAEnC,IAAI,eACNtB,IAAA,CAACF,YAAY,EAETwB,IAAI,CAAEA,IAAK,CACXsD,cAAc,CAAEA,CAAA,GAAMnD,WAAW,CAACH,IAAI,CAAE,EAFnCA,IAAI,CAAC4B,GAGb,CACJ,CACR,EACM,CAAC,cACZlD,IAAA,CAACf,WAAW,EAAAsB,QAAA,cACRP,IAAA,CAACZ,MAAM,EAACwE,OAAO,CAAET,YAAa,CAAC0B,WAAW,CAAC,MAAM,CAAAtE,QAAA,CAAC,aAElD,CAAQ,CAAC,CACA,CAAC,EACJ,CAAC,EACZ,CAAC,EACV,CAAC,CAEX,CAAC,CAED,cAAe,CAAAF,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}